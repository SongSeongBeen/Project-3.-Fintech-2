<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyPay - ÏÜ°Í∏àÌïòÍ∏∞</title>
    <link rel="stylesheet" href="/css/common.css">
    <script defer src="/js/common.js"></script>
    <!-- Updated: 2024-08-01 Modal and Balance Card Colors -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
            padding-top: 220px;
            padding-bottom: 100px;
        }

        /* Ìó§Îçî */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 20px rgba(102, 126, 234, 0.3);
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            z-index: 101;
        }

        .header h1 {
            font-size: 22px;
            font-weight: 600;
        }

        .header-back {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-back:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .header-back:active {
            background: rgba(255, 255, 255, 0.1);
        }

        /* ÌòÑÏû¨ ÏûîÏï° Ïπ¥Îìú - Í∏∞Î≥∏ */
        .balance-card {
            padding: 20px;
            border-radius: 16px;
            color: white;
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%) translateY(-3px);
            width: 100%;
            max-width: 480px;
            z-index: 100;
            overflow: hidden;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            margin: 0;
            transition: all 0.5s ease;
            box-sizing: border-box;
        }

        /* ÏûîÏï°Î≥Ñ ÏÉâÏÉÅ ÌÅ¥ÎûòÏä§ */
        .balance-card.tier-1 { /* 1Ï≤úÎßåÏõê ÎØ∏Îßå - Ïó∞Ìïú Î≥¥ÎùºÏÉâ */
            background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 100%);
        }

        .balance-card.tier-2 { /* 1Ï≤úÎßåÏõê~5Ï≤úÎßåÏõê - Ï§ëÍ∞Ñ Î≥¥ÎùºÏÉâ */
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
        }

        .balance-card.tier-3 { /* 5Ï≤úÎßåÏõê~1Ïñµ - ÏßÑÌïú Î≥¥ÎùºÏÉâ */
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }

        .balance-card.tier-4 { /* 1Ïñµ~10Ïñµ - Îçî ÏßÑÌïú Î≥¥ÎùºÏÉâ */
            background: linear-gradient(135deg, #7c3aed 0%, #6b46c1 100%);
        }

        .balance-card.tier-vip { /* 10Ïñµ Ïù¥ÏÉÅ - ÌäπÎ≥ÑÌïú Í≥®Îìú Í∑∏ÎùºÎç∞Ïù¥ÏÖò */
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
            animation: vipGlow 3s ease-in-out infinite alternate;
        }

        @keyframes vipGlow {
            0% {
                transform: translateX(-50%) translateY(-3px) scale(1);
            }
            100% {
                transform: translateX(-50%) translateY(-5px) scale(1.02);
            }
        }

        .balance-card.tier-vip::before {
            background: rgba(255, 255, 255, 0.2);
            animation: sparkle 2s linear infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.4; }
        }

        .balance-card.tier-vip .balance-amount {
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5), 0 0 15px rgba(255, 255, 255, 0.3);
            animation: amountGlow 2s ease-in-out infinite alternate;
        }

        @keyframes amountGlow {
            0% { text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5), 0 0 15px rgba(255, 255, 255, 0.3); }
            100% { text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 255, 255, 0.5); }
        }


        .balance-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .balance-card-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
        }

        .balance-left {
            flex: 1;
        }

        .balance-right {
            flex: 0 0 auto;
            text-align: right;
            min-width: 120px;
        }

        .balance-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .balance-amount {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
            color: #ffffff !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .balance-account {
            font-size: 12px;
            opacity: 1;
            color: #1a1a1a !important;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 6px;
            display: inline-block;
            margin-top: 4px;
        }
        
        .balance-info {
            margin-top: 8px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 400;
        }
        
        .info-separator {
            margin: 0 8px;
            opacity: 0.6;
        }

        .receiver-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
            margin-bottom: 6px;
        }

        .receiver-account {
            font-size: 13px;
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 4px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .receiver-bank {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
            font-weight: 500;
        }

        /* ÏàòÏã†Ïûê ÏÑ†ÌÉù ÏÑπÏÖò */
        .recipient-section {
            padding: 20px;
            margin: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin: 20px 0 16px 0;
            color: #333;
        }

        .recipient-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 4px;
            margin-top: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .tab-button {
            flex: 1;
            padding: 14px;
            border: none;
            margin-top: 3px;
            background: transparent;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 100%);
            color: white;
            box-shadow: 0 6px 16px rgba(196, 181, 253, 0.4), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-button:hover:not(.active) {
            background: rgba(196, 181, 253, 0.2);
            color: #8b5cf6;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(196, 181, 253, 0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Í≥ÑÏ¢åÎ≤àÌò∏ ÏûÖÎ†• */
        .account-input-section {
            margin-bottom: 20px;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-with-camera {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .account-input {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .account-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-1px);
        }

        .camera-button {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #93c5fd 0%, #3b82f6 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 6px 16px rgba(147, 197, 253, 0.4), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .camera-button:hover {
            background: linear-gradient(135deg, #7dd3fc 0%, #2563eb 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(147, 197, 253, 0.5), 
                        0 4px 8px rgba(0, 0, 0, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .camera-button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 8px rgba(147, 197, 253, 0.3), 
                        0 1px 2px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        /* ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù */
        .my-accounts-section {
            margin-bottom: 20px;
        }

        .accounts-toggle {
            width: 100%;
            padding: 16px;
            background: white;
            border: 1px solid rgba(102, 126, 234, 0.1);
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .accounts-toggle:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .accounts-toggle-text {
            font-size: 14px;
            color: #666;
        }

        .accounts-count {
            background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 100%);
            color: white;
            padding: 6px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(196, 181, 253, 0.3), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .accounts-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
            border-radius: 12px;
            margin-top: 8px;
        }

        .accounts-list.expanded {
            max-height: 300px;
            border: 1px solid #e9ecef;
        }

        .account-item {
            padding: 12px 16px;
            border-bottom: 1px solid #f8f9fa;
            cursor: pointer;
            transition: background 0.2s;
        }

        .account-item:hover {
            background: #f8f9fa;
        }

        .account-item:last-child {
            border-bottom: none;
        }

        .account-info {
            font-size: 14px;
            color: #333;
        }

        .account-number {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        /* ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ */
        .recent-section {
            margin-bottom: 20px;
        }

        .recent-transfers {
            background: white;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.1);
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .transfer-item {
            padding: 16px;
            border-bottom: 1px solid #f8f9fa;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .transfer-item:hover {
            background: #f8f9fa;
        }

        .transfer-item:last-child {
            border-bottom: none;
        }

        .transfer-info {
            flex: 1;
        }

        .transfer-name {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }

        .transfer-details {
            font-size: 12px;
            color: #666;
        }

        .favorite-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: #ddd;
            font-size: 16px;
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .favorite-btn.active {
            color: #ffc107;
        }

        .favorite-btn:hover {
            background: #f8f9fa;
        }

        /* ÏÜ°Í∏à Ìèº */
        .transfer-form {
            padding: 20px;
            margin: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }
        
        .form-guide {
            margin-top: 12px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .guide-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #666;
        }
        
        .guide-input {
            font-size: 16px;
            padding: 16px;
        }

        .form-input {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-1px);
        }

        .amount-group {
            position: relative;
        }

        .amount-input {
            padding-right: 50px;
        }

        .currency-label {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-weight: 500;
            pointer-events: none;
        }

        .memo-input {
            resize: vertical;
            min-height: 80px;
        }

        .error-message {
            color: #dc3545;
            font-size: 12px;
            margin-top: 6px;
        }

        /* ÌïòÎã® Í≥†Ï†ï Î≤ÑÌäº */
        .bottom-section {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            background: white;
            padding: 20px;
            border-top: 1px solid #e9ecef;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.1);
        }

        .submit-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5), 
                        0 3px 8px rgba(0, 0, 0, 0.15),
                        inset 0 2px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .submit-button:hover {
            transform: translateY(-4px);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4492 100%);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6), 
                        0 4px 12px rgba(0, 0, 0, 0.2),
                        inset 0 2px 0 rgba(255, 255, 255, 0.3);
        }

        .submit-button:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4), 
                        0 2px 6px rgba(0, 0, 0, 0.1),
                        inset 0 2px 0 rgba(255, 255, 255, 0.1);
        }

        .submit-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(156, 163, 175, 0.3), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            opacity: 0.7;
        }

        /* Î°úÎî© ÏÉÅÌÉú */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Í≤ÄÏÉâ Í∏∞Îä• */
        .search-box {
            margin-bottom: 16px;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 480px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
        }

        /* Ï†ëÍ∑ºÏÑ± Í∞úÏÑ† */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Í≥†ÎåÄÎπÑ Î™®Îìú */
        @media (prefers-contrast: high) {
            .submit-button {
                border: 2px solid #000;
            }
        }

        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: transparent;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            position: relative;
            animation: modalSlideUp 0.3s ease-out;
            display: flex;
            flex-direction: column;
            padding-top: 80px;
            padding-bottom: 80px;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px 16px 0 0;
            position: relative;
            z-index: 1001;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            margin: 0;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            font-size: 24px;
            color: white;
            cursor: pointer;
            padding: 0;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25), 
                        0 3px 6px rgba(0, 0, 0, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .modal-close:active {
            transform: translateY(0px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 
                        0 1px 2px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 30px 20px;
            flex: 1;
            overflow-y: auto;
            max-height: calc(80vh - 200px);
            background: white;
        }

        .modal-body::-webkit-scrollbar {
            width: 6px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .account-input-modal {
            background: white;
            padding: 20px;
            margin: 0;
            border-bottom: 1px solid #e9ecef;
        }

        .account-input-modal input {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .account-input-modal input:focus {
            outline: none;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-1px);
        }

        .account-input-modal input::placeholder {
            color: #666;
            font-weight: 400;
        }

        .bank-section {
            margin: 25px 0 40px 0;
        }

        .section-header {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bank-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .bank-item {
            padding: 16px 12px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .bank-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }

        .bank-item.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .bank-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .bank-name {
            font-size: 14px;
            font-weight: 500;
        }

        .securities-section {
            border-top: 1px solid #e9ecef;
            padding-top: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            gap: 12px;
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 0 0 16px 16px;
            z-index: 1001;
            box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.3);
            margin: 0;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-cancel {
            background: #d1d5db;
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(209, 213, 219, 0.3), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-btn-cancel:hover {
            background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(196, 181, 253, 0.4), 
                        0 3px 6px rgba(0, 0, 0, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .modal-btn-cancel:active {
            transform: translateY(0px);
            box-shadow: 0 2px 8px rgba(209, 213, 219, 0.2), 
                        0 1px 2px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .modal-btn-confirm {
            background: #d1d5db;
            color: white;
            font-weight: 700;
            border: none;
            box-shadow: 0 4px 12px rgba(209, 213, 219, 0.3), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-btn-confirm:hover:not(:disabled) {
            background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(196, 181, 253, 0.4), 
                        0 3px 6px rgba(0, 0, 0, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .modal-btn-confirm:active:not(:disabled) {
            transform: translateY(0px);
            box-shadow: 0 2px 8px rgba(209, 213, 219, 0.2), 
                        0 1px 2px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .modal-btn-confirm.active {
            background: linear-gradient(135deg, #b794f6 0%, #9f7aea 100%);
            color: white;
            box-shadow: 0 6px 16px rgba(183, 148, 246, 0.4), 
                        0 3px 6px rgba(0, 0, 0, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-btn-confirm.active:hover {
            transform: translateY(-3px);
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
            box-shadow: 0 8px 20px rgba(183, 148, 246, 0.5), 
                        0 4px 8px rgba(0, 0, 0, 0.2),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .modal-btn-confirm.active:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(183, 148, 246, 0.3), 
                        0 2px 4px rgba(0, 0, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .modal-btn-confirm:disabled {
            background: #d1d5db;
            color: white;
            cursor: not-allowed;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(209, 213, 219, 0.2), 
                        0 2px 4px rgba(0, 0, 0, 0.05),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            opacity: 0.7;
        }
        
        /* ÏÜ°Í∏à ÌôïÏù∏ Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .confirm-section {
            padding: 10px 0;
        }
        
        .confirm-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .confirm-item:last-child {
            border-bottom: none;
        }
        
        .confirm-label {
            font-size: 14px;
            font-weight: 500;
            color: #666;
            min-width: 80px;
        }
        
        .confirm-value {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            text-align: right;
            flex: 1;
        }
        
        .confirm-value.highlight {
            color: #667eea;
            font-size: 18px;
            font-weight: 700;
        }

        /* Í≥µÌÜµ Alert Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .alert-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .alert-overlay.show {
            display: flex;
        }

        .alert-content {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            position: relative;
            animation: alertSlideUp 0.3s ease-out;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        @keyframes alertSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .alert-header {
            padding: 20px 20px 10px 20px;
            text-align: center;
        }

        .alert-icon {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }

        .alert-icon.success { color: #10b981; }
        .alert-icon.error { color: #ef4444; }
        .alert-icon.warning { color: #f59e0b; }
        .alert-icon.info { color: #3b82f6; }

        .alert-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .alert-message {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            padding: 0 20px 20px 20px;
            text-align: center;
        }

        .alert-actions {
            padding: 0 20px 20px 20px;
            display: flex;
            gap: 10px;
        }

        .alert-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .alert-btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .alert-btn-primary:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
            transform: translateY(-1px);
        }

        .alert-btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .alert-btn-secondary:hover {
            background: #e5e7eb;
            transform: translateY(-1px);
        }

        /* 6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†• Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .pin-input-section {
            padding: 20px;
            text-align: center;
        }

        .pin-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .pin-display {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0 30px 0;
        }

        .pin-digit {
            width: 40px;
            height: 40px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            color: #333;
            background: white;
            transition: all 0.3s ease;
        }

        .pin-digit.filled {
            border-color: #667eea;
            background: #f0f4ff;
            color: #667eea;
        }

        .pin-digit.error {
            border-color: #ef4444;
            background: #fef2f2;
            color: #ef4444;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 300px;
            margin: 0 auto;
        }

        .keypad-btn {
            width: 60px;
            height: 60px;
            border: none;
            border-radius: 50%;
            background: #f8f9fa;
            color: #333;
            font-size: 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .keypad-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .keypad-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .keypad-btn.delete {
            background: #fee2e2;
            color: #dc2626;
            font-size: 18px;
        }

        .keypad-btn.delete:hover {
            background: #fecaca;
        }

        .keypad-btn:disabled {
            background: #f3f4f6;
            color: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .pin-error-message {
            color: #ef4444;
            font-size: 12px;
            margin-top: 10px;
            min-height: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <header class="header">
            <h1>ÏÜ°Í∏àÌïòÍ∏∞</h1>
            <button class="header-back" onclick="goBack()">‚åÇ</button>
        </header>
        
        <!-- ÌòÑÏû¨ ÏûîÏï° Ïπ¥Îìú -->
        <div class="balance-card">
            <div class="balance-card-content">
                <div class="balance-left">
                    <div class="balance-label">ÌòÑÏû¨ ÏûîÏï°</div>
                    <div class="balance-amount" id="currentBalance">Î°úÎî© Ï§ë...</div>
                    <div class="balance-account" id="currentAccount">Í≥ÑÏ¢åÎ≤àÌò∏: Î°úÎî© Ï§ë...</div>
                    <div class="balance-info">
                        <span id="senderBank">ÏùÄÌñâ: Î°úÎî© Ï§ë</span>
                        <span class="info-separator">¬∑</span>
                        <span id="senderName">Ïù¥Î¶Ñ: Î°úÎî© Ï§ë</span>
                    </div>
                </div>
                <div class="balance-right">
                    <div class="receiver-label">Î∞õÎäî ÏÇ¨Îûå</div>
                    <div class="receiver-account" id="receiverAccountDisplay"></div>
                    <div class="receiver-bank" id="receiverBankDisplay"></div>
                </div>
            </div>
        </div>

        <!-- ÏàòÏã†Ïûê ÏÑ†ÌÉù ÏÑπÏÖò -->
        <div class="recipient-section">
            <h2 class="section-title">Ïñ¥ÎîîÎ°ú ÎèàÏùÑ Î≥¥ÎÇºÍπåÏöî?</h2>
            
            <!-- ÌÉ≠ Î≤ÑÌäº -->
            <div class="recipient-tabs">
                <button class="tab-button active" onclick="switchTab('account')">Í≥ÑÏ¢å</button>
                <button class="tab-button" onclick="switchTab('contact')">Ïó∞ÎùΩÏ≤ò</button>
            </div>

            <!-- Í≥ÑÏ¢å ÌÉ≠ ÎÇ¥Ïö© -->
            <div class="tab-content active" id="account-tab">
                <!-- Í≥ÑÏ¢åÎ≤àÌò∏ ÏßÅÏ†ë ÏûÖÎ†• -->
                <div class="account-input-section">
                    <div class="input-group">
                        <div class="input-with-camera">
                            <input type="text" class="account-input" id="accountInput" 
                                   placeholder="Í≥ÑÏ¢åÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" maxlength="20" readonly style="cursor: pointer;">
                            <button class="camera-button" onclick="openCamera()" title="Ïπ¥Î©îÎùºÎ°ú Í≥ÑÏ¢åÎ≤àÌò∏ Ïù∏Ïãù">
                                üì∑
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù -->
                <div class="my-accounts-section">
                    <button class="accounts-toggle" onclick="toggleMyAccounts()">
                        <span class="accounts-toggle-text">ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù</span>
                        <span class="accounts-count" id="myAccountsCount">0</span>
                    </button>
                    <div class="accounts-list" id="myAccountsList">
                        <!-- ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>

                <!-- ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ -->
                <div class="recent-section">
                    <h3 class="section-title">ÏµúÍ∑º ÏÜ°Í∏à Í≥ÑÏ¢å</h3>
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchInput" 
                               placeholder="Í≥ÑÏ¢åÎ≤àÌò∏ÎÇò Ïù¥Î¶ÑÏúºÎ°ú Í≤ÄÏÉâ" onkeyup="searchRecentTransfers()">
                    </div>
                    <div class="recent-transfers" id="recentTransfers">
                        <!-- ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>

            <!-- Ïó∞ÎùΩÏ≤ò ÌÉ≠ ÎÇ¥Ïö© -->
            <div class="tab-content" id="contact-tab">
                <!-- Ïó∞ÎùΩÏ≤ò ÏûÖÎ†• ÏÑπÏÖò (Í≥ÑÏ¢å ÌÉ≠Í≥º ÎÜíÏù¥ ÎßûÏ∂§) -->
                <div class="account-input-section">
                    <div class="input-group">
                        <div class="input-with-camera">
                            <input type="text" class="account-input" id="contactInput" 
                                   placeholder="Ïó∞ÎùΩÏ≤òÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" maxlength="13" readonly style="cursor: pointer;">
                            <button class="camera-button" onclick="openContactSearch()" title="Ïó∞ÎùΩÏ≤ò Í≤ÄÏÉâ">
                                üìû
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò (ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ùÍ≥º ÎèôÏùºÌïú Íµ¨Ï°∞) -->
                <div class="my-accounts-section">
                    <button class="accounts-toggle" onclick="toggleFavoriteContacts()">
                        <span class="accounts-toggle-text">Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò</span>
                        <span class="accounts-count" id="favoriteContactsCount">0</span>
                    </button>
                    <div class="accounts-list" id="favoriteContactsList">
                        <!-- Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤òÍ∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>

                <!-- Î™®Îì† Ïó∞ÎùΩÏ≤ò -->
                <div class="recent-section">
                    <h3 class="section-title">Ïó∞ÎùΩÏ≤ò Î™©Î°ù</h3>
                    <div class="search-box">
                        <input type="text" class="search-input" id="contactSearch" 
                               placeholder="Ïó∞ÎùΩÏ≤ò Í≤ÄÏÉâ" onkeyup="searchContacts()">
                    </div>
                    <div class="recent-transfers" id="contactList">
                        <!-- Ïó∞ÎùΩÏ≤ò Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏÜ°Í∏à Ìèº -->
        <form class="transfer-form" id="transferForm">
            <h2 class="section-title">ÏÜ°Í∏à Ï†ïÎ≥¥ ÏûÖÎ†•</h2>
            <div class="form-group">
                <label class="form-label" for="senderName">Î∞õÎäîÍ≥ÑÏ¢åÏóê ÌëúÏãú</label>
                <input type="text" class="form-input" id="senderName" 
                       placeholder="Î∞õÎäî Í≥ÑÏ¢åÏóê ÌëúÏãúÎê† Ïù¥Î¶Ñ" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="receiverDisplay">ÎÇ¥Í≥ÑÏ¢åÏóê ÌëúÏãú</label>
                <input type="text" class="form-input" id="receiverDisplay" 
                       placeholder="Î∞õÎäîÎ∂Ñ Ïù¥Î¶ÑÌëúÏãú">
            </div>

            <div class="form-group">
                <label class="form-label" for="amount">ÏÜ°Í∏à Í∏àÏï°</label>
                <div class="amount-group">
                    <input type="text" class="form-input amount-input" id="amount" 
                           placeholder="ÏÜ°Í∏àÌï† Í∏àÏï°ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" oninput="formatAmount(this)" required>
                    <span class="currency-label">Ïõê</span>
                </div>
                <div class="error-message" id="amountError"></div>
            </div>

            <div class="form-group">
                <label class="form-label" for="memo">ÏÜ°Í∏à Î©îÎ™® (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                <textarea class="form-input memo-input" id="memo" 
                          placeholder="ÏÜ°Í∏à Î™©Ï†ÅÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÏµúÎåÄ 100Ïûê)" maxlength="100"></textarea>
            </div>

            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                ÏÜ°Í∏à Ï≤òÎ¶¨ Ï§ë...
            </div>
        </form>

        <!-- ÌïòÎã® Í≥†Ï†ï Î≤ÑÌäº -->
        <div class="bottom-section">
            <button type="submit" class="submit-button" id="submitButton" onclick="handleTransfer()">
                ÏÜ°Í∏àÌïòÍ∏∞
            </button>
        </div>
    </div>

    <!-- Í≥ÑÏ¢å ÏÑ†ÌÉù Î™®Îã¨ -->
    <div class="modal-overlay" id="accountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Ïñ¥Îñ§ Í≥ÑÏ¢åÎ°ú Î≥¥ÎÇºÍπåÏöî?</h3>
                <button class="modal-close" onclick="closeAccountModal()">√ó</button>
            </div>
            <div class="account-input-modal">
                <input type="text" id="modalAccountInput" placeholder="Í≥ÑÏ¢åÎ≤àÌò∏ ÏûÖÎ†•" maxlength="20">
            </div>
            <div class="modal-body">
                <div class="bank-section">
                    <div class="section-header">
                        <span>üè¶</span> ÏùÄÌñâÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî
                    </div>
                    <div class="bank-grid" id="bankGrid">
                        <!-- ÏùÄÌñâ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
                
                <div class="securities-section">
                    <div class="section-header">
                        <span>üìä</span> Ï¶ùÍ∂åÏÇ¨
                    </div>
                    <div class="bank-grid" id="securitiesGrid">
                        <!-- Ï¶ùÍ∂åÏÇ¨ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" onclick="closeAccountModal()">Ï∑®ÏÜå</button>
                <button class="modal-btn modal-btn-confirm" id="confirmAccountBtn" onclick="confirmAccount()" disabled>ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- ÏÜ°Í∏à ÌôïÏù∏ Î™®Îã¨ -->
    <div class="modal-overlay" id="transferConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ÏÜ°Í∏à Ï†ïÎ≥¥ ÌôïÏù∏</h3>
                <button class="modal-close" onclick="closeTransferConfirmModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="confirm-section">
                    <div class="confirm-item">
                        <label class="confirm-label">Î∞õÎäî ÏÇ¨Îûå Í≥ÑÏ¢åÎ≤àÌò∏</label>
                        <div class="confirm-value" id="confirmAccountNumber">-</div>
                    </div>
                    <div class="confirm-item">
                        <label class="confirm-label">ÏùÄÌñâ</label>
                        <div class="confirm-value" id="confirmBank">-</div>
                    </div>
                    <div class="confirm-item">
                        <label class="confirm-label">Î∞õÎäî ÏÇ¨Îûå Ïù¥Î¶Ñ</label>
                        <div class="confirm-value" id="confirmReceiverName">-</div>
                    </div>
                    <div class="confirm-item">
                        <label class="confirm-label">ÏÜ°Í∏à Í∏àÏï°</label>
                        <div class="confirm-value highlight" id="confirmAmount">-</div>
                    </div>
                    <div class="confirm-item">
                        <label class="confirm-label">ÏÜ°Í∏à Î©îÎ™®</label>
                        <div class="confirm-value" id="confirmMemo">-</div>
                    </div>
                </div>
                
                <!-- 6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†• ÏÑπÏÖò -->
                <div class="pin-input-section">
                    <div class="pin-title">6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî</div>
                    <div class="pin-display">
                        <div class="pin-digit" id="pin1"></div>
                        <div class="pin-digit" id="pin2"></div>
                        <div class="pin-digit" id="pin3"></div>
                        <div class="pin-digit" id="pin4"></div>
                        <div class="pin-digit" id="pin5"></div>
                        <div class="pin-digit" id="pin6"></div>
                    </div>
                    <div class="keypad" id="keypad">
                        <!-- ÌÇ§Ìå®Îìú Î≤ÑÌäºÎì§Ïù¥ JavaScriptÎ°ú ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                    <div class="pin-error-message" id="pinErrorMessage"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" onclick="closeTransferConfirmModal()">Ï∑®ÏÜå</button>
                <button class="modal-btn modal-btn-confirm" onclick="processTransferConfirm()">ÏÜ°Í∏àÌïòÍ∏∞</button>
            </div>
        </div>
    </div>

    <!-- Í≥µÌÜµ Alert Î™®Îã¨ -->
    <div class="alert-overlay" id="alertModal">
        <div class="alert-content">
            <div class="alert-header">
                <span class="alert-icon" id="alertIcon">‚ÑπÔ∏è</span>
                <div class="alert-title" id="alertTitle">ÏïåÎ¶º</div>
            </div>
            <div class="alert-message" id="alertMessage">Î©îÏãúÏßÄÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>
            <div class="alert-actions">
                <button class="alert-btn alert-btn-secondary" id="alertCancelBtn" onclick="closeAlert()" style="display: none;">Ï∑®ÏÜå</button>
                <button class="alert-btn alert-btn-primary" id="alertConfirmBtn" onclick="closeAlert()">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentUser = null;
        let myAccounts = [];
        let recentTransfers = [];
        let contacts = [];
        let favorites = JSON.parse(localStorage.getItem('transferFavorites') || '[]');
        let favoriteContactList = JSON.parse(localStorage.getItem('favoriteContacts') || '[]');
        let selectedBank = null;
        let modalAccountNumber = '';
        
        // Ïù∏Ï¶ùÎ≤àÌò∏ Í¥ÄÎ†® Î≥ÄÏàò
        let currentPin = '';
        let registeredPin = '123456'; // Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò§Í±∞ÎÇò ÏÇ¨Ïö©ÏûêÍ∞Ä Îì±Î°ùÌïú PIN
        let keypadNumbers = [];
        let alertCallback = null;
        let pinAuthCallback = null;
        let pinAuthType = '';
        let pinMaxAttempts = 5;
        let pinCurrentAttempts = 0;

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', async function() {
            // ÏÑúÎ≤ÑÏóêÏÑú ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÏÑ§Ï†ï Î°úÎìú
            await loadClientConfig();
            
            // ÏÑúÎ≤Ñ ÏÑ§Ï†ïÏùÑ ÏÇ¨Ïö©Ìïú ÌÜ†ÌÅ∞ Ï≤¥ÌÅ¨ ÏãúÏûë
            setInterval(checkTokenExpiration, clientConfig.accessCheckInterval);
            setInterval(backgroundTokenCheck, clientConfig.backgroundCheckInterval);
            
            // Ï¥àÍ∏∞ ÌÜ†ÌÅ∞ Ï≤¥ÌÅ¨Îäî Ï¶âÏãú Ïã§Ìñâ
            checkTokenExpiration();
            backgroundTokenCheck();
            
            checkAuth();
            loadBalance();
            loadUserInfo();
            loadMyAccounts();
            loadRecentTransfers();
            loadContacts();
            initializeBankData();
            initializeKeypad();
            
            // Í≥ÑÏ¢åÎ≤àÌò∏ ÏûÖÎ†• ÌïÑÎìú ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            const accountInput = document.getElementById('accountInput');
            if (accountInput) {
                accountInput.addEventListener('click', function(e) {
                    e.preventDefault();
                    openAccountModal();
                });
            }
        });

        // Í≥µÌÜµ Alert Ìï®ÏàòÎì§
        function showAlert(message, type = 'info', title = 'ÏïåÎ¶º', showCancel = false, callback = null) {
            const alertModal = document.getElementById('alertModal');
            const alertIcon = document.getElementById('alertIcon');
            const alertTitle = document.getElementById('alertTitle');
            const alertMessage = document.getElementById('alertMessage');
            const alertCancelBtn = document.getElementById('alertCancelBtn');
            const alertConfirmBtn = document.getElementById('alertConfirmBtn');
            
            // ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            alertIcon.textContent = icons[type] || icons.info;
            alertIcon.className = `alert-icon ${type}`;
            alertTitle.textContent = title;
            alertMessage.textContent = message;
            
            // Ï∑®ÏÜå Î≤ÑÌäº ÌëúÏãú/Ïà®ÍπÄ
            if (showCancel) {
                alertCancelBtn.style.display = 'block';
            } else {
                alertCancelBtn.style.display = 'none';
            }
            
            // ÏΩúÎ∞± Ìï®Ïàò Ï†ÄÏû•
            alertCallback = callback;
            
            // Î™®Îã¨ ÌëúÏãú
            alertModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeAlert(confirmed = true) {
            const alertModal = document.getElementById('alertModal');
            alertModal.classList.remove('show');
            document.body.style.overflow = '';
            
            // ÏΩúÎ∞± Ïã§Ìñâ
            if (alertCallback && typeof alertCallback === 'function') {
                alertCallback(confirmed);
                alertCallback = null;
            }
        }

        // Í∏∞Ï°¥ alertÎ•º showAlertÎ°ú ÎåÄÏ≤¥ÌïòÎäî Ìï®Ïàò
        function customAlert(message) {
            showAlert(message, 'info');
        }

        // Í≥µÌÜµ PIN Ïù∏Ï¶ù Ìï®Ïàò
        function showPinAuthentication(type, options = {}, callback) {
            pinAuthType = type;
            pinAuthCallback = callback;
            pinMaxAttempts = options.maxAttempts || 5;
            pinCurrentAttempts = 0;
            
            // ÌÉÄÏûÖÎ≥Ñ Ï†úÎ™© ÏÑ§Ï†ï
            const titles = {
                transfer: 'ÏÜ°Í∏à Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•',
                payment: 'Í≤∞Ï†ú Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•',
                common: 'Î≥¥Ïïà Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•'
            };
            
            const title = options.title || titles[type] || titles.common;
            
            // PIN Ï†úÎ™© ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelector('.pin-title').textContent = title + '\n(6ÏûêÎ¶¨Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî)';
            
            // ÏÜ°Í∏à ÌôïÏù∏ Î™®Îã¨ ÌëúÏãú (PIN Ïù∏Ï¶ù UI Ìè¨Ìï®)
            document.getElementById('transferConfirmModal').classList.add('show');
            document.body.style.overflow = 'hidden';
            
            // PIN Ï¥àÍ∏∞Ìôî Î∞è ÌÇ§Ìå®Îìú Ïû¨ÏÉùÏÑ±
            clearPin();
            initializeKeypad();
        }

        // Í≥µÌÜµ PIN Ïù∏Ï¶ù ÏÑ±Í≥µ Ï≤òÎ¶¨
        function onPinAuthSuccess() {
            showAlert(`${getPinTypeTitle()} Ïù∏Ï¶ùÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.`, 'success', 'Ïù∏Ï¶ù ÏÑ±Í≥µ', false, () => {
                closeTransferConfirmModal();
                if (pinAuthCallback && typeof pinAuthCallback === 'function') {
                    pinAuthCallback(true);
                }
            });
        }

        // Í≥µÌÜµ PIN Ïù∏Ï¶ù Ïã§Ìå® Ï≤òÎ¶¨
        function onPinAuthFailed(message = 'Ïù∏Ï¶ùÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§.') {
            pinCurrentAttempts++;
            
            if (pinCurrentAttempts >= pinMaxAttempts) {
                showAlert(`Ïù∏Ï¶ù Ïã§Ìå® ÌöüÏàòÍ∞Ä Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§.\nÏû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.`, 'error', 'Ïù∏Ï¶ù Ïã§Ìå®', false, () => {
                    closeTransferConfirmModal();
                    if (pinAuthCallback && typeof pinAuthCallback === 'function') {
                        pinAuthCallback(false);
                    }
                });
            } else {
                const remainingAttempts = pinMaxAttempts - pinCurrentAttempts;
                showPinError(`${message}\n(ÎÇ®ÏùÄ ÏãúÎèÑ: ${remainingAttempts}Ìöå)`);
                clearPin();
            }
        }

        // PIN ÌÉÄÏûÖÎ≥Ñ Ï†úÎ™© Î∞òÌôò
        function getPinTypeTitle() {
            const titles = {
                transfer: 'ÏÜ°Í∏à',
                payment: 'Í≤∞Ï†ú',
                common: 'Î≥¥Ïïà'
            };
            return titles[pinAuthType] || 'Î≥¥Ïïà';
        }

        // ÎûúÎç§ ÌÇ§Ìå®Îìú Ï¥àÍ∏∞Ìôî
        function initializeKeypad() {
            // 0-9 Ïà´ÏûêÎ•º ÎûúÎç§ÌïòÍ≤å ÏÑûÍ∏∞
            keypadNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            shuffleArray(keypadNumbers);
            renderKeypad();
        }

        // Î∞∞Ïó¥ ÏÑûÍ∏∞ Ìï®Ïàò
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // ÌÇ§Ìå®Îìú Î†åÎçîÎßÅ
        function renderKeypad() {
            const keypad = document.getElementById('keypad');
            keypad.innerHTML = '';
            
            // 9Í∞ú Ïà´Ïûê Î≤ÑÌäº (3x3)
            for (let i = 0; i < 9; i++) {
                const button = document.createElement('button');
                button.className = 'keypad-btn';
                button.textContent = keypadNumbers[i];
                button.onclick = () => inputPin(keypadNumbers[i]);
                keypad.appendChild(button);
            }
            
            // Îπà Í≥µÍ∞Ñ
            const emptyBtn = document.createElement('button');
            emptyBtn.className = 'keypad-btn';
            emptyBtn.disabled = true;
            emptyBtn.style.visibility = 'hidden';
            keypad.appendChild(emptyBtn);
            
            // ÎßàÏßÄÎßâ Ïà´Ïûê (Î≥¥ÌÜµ 0)
            const lastButton = document.createElement('button');
            lastButton.className = 'keypad-btn';
            lastButton.textContent = keypadNumbers[9];
            lastButton.onclick = () => inputPin(keypadNumbers[9]);
            keypad.appendChild(lastButton);
            
            // ÏÇ≠Ï†ú Î≤ÑÌäº
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'keypad-btn delete';
            deleteBtn.innerHTML = '‚å´';
            deleteBtn.onclick = () => deletePin();
            keypad.appendChild(deleteBtn);
        }

        // PIN ÏûÖÎ†•
        function inputPin(number) {
            if (currentPin.length < 6) {
                currentPin += number.toString();
                updatePinDisplay();
                
                // 6ÏûêÎ¶¨Í∞Ä Î™®Îëê ÏûÖÎ†•ÎêòÎ©¥ ÏûêÎèôÏúºÎ°ú ÌôïÏù∏
                if (currentPin.length === 6) {
                    setTimeout(() => {
                        verifyPin();
                    }, 300);
                }
            }
        }

        // PIN ÏÇ≠Ï†ú
        function deletePin() {
            if (currentPin.length > 0) {
                currentPin = currentPin.slice(0, -1);
                updatePinDisplay();
                clearPinError();
            }
        }

        // PIN ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updatePinDisplay() {
            for (let i = 1; i <= 6; i++) {
                const pinDigit = document.getElementById(`pin${i}`);
                if (i <= currentPin.length) {
                    pinDigit.textContent = '‚óè';
                    pinDigit.classList.add('filled');
                    pinDigit.classList.remove('error');
                } else {
                    pinDigit.textContent = '';
                    pinDigit.classList.remove('filled', 'error');
                }
            }
        }

        // PIN ÌôïÏù∏
        function verifyPin() {
            if (currentPin === registeredPin) {
                // Ïù∏Ï¶ù ÏÑ±Í≥µ
                onPinAuthSuccess();
            } else {
                // Ïù∏Ï¶ù Ïã§Ìå®
                onPinAuthFailed();
            }
        }

        // PIN ÏóêÎü¨ ÌëúÏãú
        function showPinError(message) {
            const errorElement = document.getElementById('pinErrorMessage');
            errorElement.textContent = message;
            
            // PIN ÏûÖÎ†•Ï∞ΩÏóê ÏóêÎü¨ Ïä§ÌÉÄÏùº Ï†ÅÏö©
            for (let i = 1; i <= 6; i++) {
                const pinDigit = document.getElementById(`pin${i}`);
                pinDigit.classList.add('error');
            }
        }

        // PIN ÏóêÎü¨ ÌÅ¥Î¶¨Ïñ¥
        function clearPinError() {
            const errorElement = document.getElementById('pinErrorMessage');
            errorElement.textContent = '';
            
            // PIN ÏûÖÎ†•Ï∞ΩÏóêÏÑú ÏóêÎü¨ Ïä§ÌÉÄÏùº Ï†úÍ±∞
            for (let i = 1; i <= 6; i++) {
                const pinDigit = document.getElementById(`pin${i}`);
                pinDigit.classList.remove('error');
            }
        }

        // PIN Ï¥àÍ∏∞Ìôî
        function clearPin() {
            currentPin = '';
            updatePinDisplay();
            // ÌÇ§Ìå®Îìú Ïû¨ÏÑûÍ∏∞
            setTimeout(() => {
                initializeKeypad();
            }, 1000);
        }

        // Ïù∏Ï¶ù ÌôïÏù∏
        function checkAuth() {
            const token = localStorage.getItem('accessToken');
            if (!token) {
                showAlert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.', 'warning', 'Î°úÍ∑∏Ïù∏ ÌïÑÏöî', false, () => {
                    window.location.href = '/index.html';
                });
                return;
            }
        }

        // ÏûîÏï°Ïóê Îî∞Î•∏ Ìã∞Ïñ¥ Í≤∞Ï†ï
        function getBalanceTier(balance) {
            if (balance >= 1000000000) { // 10Ïñµ Ïù¥ÏÉÅ
                return 'tier-vip';
            } else if (balance >= 100000000) { // 1Ïñµ Ïù¥ÏÉÅ
                return 'tier-4';
            } else if (balance >= 50000000) { // 5Ï≤úÎßåÏõê Ïù¥ÏÉÅ
                return 'tier-3';
            } else if (balance >= 10000000) { // 1Ï≤úÎßåÏõê Ïù¥ÏÉÅ
                return 'tier-2';
            } else { // 1Ï≤úÎßåÏõê ÎØ∏Îßå
                return 'tier-1';
            }
        }

        // ÏûîÏï° Ï°∞Ìöå
        async function loadBalance() {
            const token = localStorage.getItem('accessToken');
            
            try {
                const response = await fetch('/accounts/balance', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    const balance = data.balance || 0;
                    const accountNumber = data.accountNumber || 'N/A';
                    
                    // ÏûîÏï° ÌëúÏãú
                    document.getElementById('currentBalance').textContent = 
                        new Intl.NumberFormat('ko-KR').format(balance) + 'Ïõê';
                    document.getElementById('currentAccount').textContent = 
                        `Í≥ÑÏ¢åÎ≤àÌò∏: ${accountNumber}`;
                    
                    // ÏûîÏï°Ïóê Îî∞Î•∏ Ïπ¥Îìú ÏÉâÏÉÅ Î≥ÄÍ≤Ω
                    const balanceCard = document.querySelector('.balance-card');
                    const tier = getBalanceTier(balance);
                    
                    // Í∏∞Ï°¥ Ìã∞Ïñ¥ ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
                    balanceCard.classList.remove('tier-1', 'tier-2', 'tier-3', 'tier-4', 'tier-vip');
                    // ÏÉà Ìã∞Ïñ¥ ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
                    balanceCard.classList.add(tier);
                    
                } else {
                    document.getElementById('currentBalance').textContent = 'Ï°∞Ìöå Ïã§Ìå®';
                    document.getElementById('currentAccount').textContent = '';
                }
            } catch (error) {
                console.error('Balance load error:', error);
                document.getElementById('currentBalance').textContent = 'Ï°∞Ìöå Ïã§Ìå®';
            }
        }
        
        // ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î°úÎìú
        async function loadUserInfo() {
            const token = localStorage.getItem('accessToken');
            
            try {
                // JWT ÌÜ†ÌÅ∞ÏóêÏÑú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Ï∂îÏ∂ú
                const tokenPayload = JSON.parse(atob(token.split('.')[1]));
                const phoneNumber = tokenPayload.sub; // Ï†ÑÌôîÎ≤àÌò∏Í∞Ä subjectÎ°ú Ï†ÄÏû•Îê®
                
                // Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú ÏÇ¨Ïö©Ïûê Ïù¥Î¶Ñ Í∞ÄÏ†∏Ïò§Í∏∞ (Ïã§Ï†úÎ°úÎäî API Ìò∏Ï∂ú)
                const userName = localStorage.getItem('userName') || 'ÏÇ¨Ïö©Ïûê';
                const bankName = 'EasyPay'; // Í∏∞Î≥∏ ÏùÄÌñâ
                
                // ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÏùÑ Í∏∞Î≥∏Í∞íÏúºÎ°ú ÏÑ§Ï†ï
                const senderNameInput = document.getElementById('senderName');
                if (senderNameInput && !senderNameInput.value) {
                    senderNameInput.value = userName;
                }
                
                // ÏûîÏï° Ïπ¥ÎìúÏóê Ï†ïÎ≥¥ ÌëúÏãú
                document.getElementById('senderBank').textContent = `ÏùÄÌñâ: ${bankName}`;
                document.getElementById('senderName').textContent = `Ïù¥Î¶Ñ: ${userName}`;
            } catch (error) {
                console.error('ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù Î°úÎìú (Î™®Ïùò Îç∞Ïù¥ÌÑ∞)
        function loadMyAccounts() {
            // Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞
            myAccounts = [
                { bank: 'EasyPay', accountNumber: 'VA12345678', balance: 150000 },
                { bank: 'Íµ≠ÎØºÏùÄÌñâ', accountNumber: '123-45-678901', balance: 250000 },
                { bank: 'Ïã†ÌïúÏùÄÌñâ', accountNumber: '987-65-432109', balance: 180000 }
            ];

            document.getElementById('myAccountsCount').textContent = myAccounts.length;
            renderMyAccounts();
        }

        // ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù Î†åÎçîÎßÅ
        function renderMyAccounts() {
            const container = document.getElementById('myAccountsList');
            container.innerHTML = myAccounts.map(account => `
                <div class="account-item" onclick="selectMyAccount('${account.accountNumber}', '${account.bank}')">
                    <div class="account-info">${account.bank}</div>
                    <div class="account-number">${account.accountNumber} (${new Intl.NumberFormat('ko-KR').format(account.balance)}Ïõê)</div>
                </div>
            `).join('');
        }

        // ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ Î°úÎìú (Î™®Ïùò Îç∞Ïù¥ÌÑ∞)
        function loadRecentTransfers() {
            // Ïã§Ï†úÎ°úÎäî ÏÑúÎ≤ÑÏóêÏÑú Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞ (ÏµúÎåÄ 15Í∞ú)
            recentTransfers = [
                { id: 1, name: 'ÍπÄÏ≤†Ïàò', bank: 'Íµ≠ÎØºÏùÄÌñâ', accountNumber: '123-45-678901', lastAmount: 50000, date: '2024-01-15' },
                { id: 2, name: 'Î∞ïÏòÅÌù¨', bank: 'Ïã†ÌïúÏùÄÌñâ', accountNumber: '987-65-432109', lastAmount: 30000, date: '2024-01-14' },
                { id: 3, name: 'Ïù¥ÎØºÏàò', bank: 'Ïö∞Î¶¨ÏùÄÌñâ', accountNumber: '555-66-777888', lastAmount: 100000, date: '2024-01-13' },
                { id: 4, name: 'Ï†ïÏàòÏßÑ', bank: 'ÌïòÎÇòÏùÄÌñâ', accountNumber: '111-22-333444', lastAmount: 75000, date: '2024-01-12' },
                { id: 5, name: 'ÏµúÎèôÌõà', bank: 'KBÍµ≠ÎØºÏùÄÌñâ', accountNumber: '999-88-777666', lastAmount: 25000, date: '2024-01-11' }
            ];

            // Ï¶êÍ≤®Ï∞æÍ∏∞ Ï†ïÎ≥¥Í∞Ä Î°úÎìúÎêú ÌõÑ Î†åÎçîÎßÅ (ÌéòÏù¥ÏßÄ Î°úÎìú ÏãúÏóêÎèÑ Ï¶êÍ≤®Ï∞æÍ∏∞ ÏàúÏÑú Ï†ÅÏö©)
            console.log('Î°úÎìúÎêú Ï¶êÍ≤®Ï∞æÍ∏∞:', favorites);
            renderRecentTransfers(recentTransfers);
        }

        // ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ Î†åÎçîÎßÅ
        function renderRecentTransfers(transfers) {
            const container = document.getElementById('recentTransfers');
            if (transfers.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠Ïù¥ ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            // Ï¶êÍ≤®Ï∞æÍ∏∞Îêú Ìï≠Î™©ÏùÑ ÏÉÅÎã®Ïóê, ÎÇòÎ®∏ÏßÄÎ•º ÌïòÎã®Ïóê Î∞∞Ïπò
            const favoriteTransfers = transfers.filter(transfer => favorites.includes(transfer.id));
            const regularTransfers = transfers.filter(transfer => !favorites.includes(transfer.id));
            const sortedTransfers = [...favoriteTransfers, ...regularTransfers];

            container.innerHTML = sortedTransfers.map(transfer => `
                <div class="transfer-item" onclick="selectRecentTransfer('${transfer.accountNumber}', '${transfer.name}', '${transfer.bank}')">
                    <div class="transfer-info">
                        <div class="transfer-name">${transfer.name}</div>
                        <div class="transfer-details">${transfer.bank} ${transfer.accountNumber}</div>
                    </div>
                    <button class="favorite-btn ${favorites.includes(transfer.id) ? 'active' : ''}" 
                            onclick="toggleFavorite(event, ${transfer.id})">‚òÖ</button>
                </div>
            `).join('');
        }

        // Ïó∞ÎùΩÏ≤ò Î°úÎìú (Î™®Ïùò Îç∞Ïù¥ÌÑ∞)
        function loadContacts() {
            // Ïã§Ï†úÎ°úÎäî Ïó∞ÎùΩÏ≤ò APIÏóêÏÑú Í∞ÄÏ†∏Ïò¨ Îç∞Ïù¥ÌÑ∞
            contacts = [
                { id: 1, name: 'ÍπÄÏ≤†Ïàò', phone: '010-1234-5678', bank: 'Íµ≠ÎØºÏùÄÌñâ', accountNumber: '123-45-678901' },
                { id: 2, name: 'Î∞ïÏòÅÌù¨', phone: '010-2345-6789', bank: 'Ïã†ÌïúÏùÄÌñâ', accountNumber: '987-65-432109' },
                { id: 3, name: 'Ïù¥ÎØºÏàò', phone: '010-3456-7890', bank: 'Ïö∞Î¶¨ÏùÄÌñâ', accountNumber: '555-66-777888' }
            ];

            // Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            updateFavoriteContactsCount();
            renderFavoriteContacts();
            renderContacts(contacts);
        }

        // Ïó∞ÎùΩÏ≤ò Î†åÎçîÎßÅ
        function renderContacts(contactList) {
            const container = document.getElementById('contactList');
            if (contactList.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">Ïó∞ÎùΩÏ≤òÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            // Ï¶êÍ≤®Ï∞æÍ∏∞Îêú Ïó∞ÎùΩÏ≤òÎ•º ÏÉÅÎã®Ïóê, ÎÇòÎ®∏ÏßÄÎ•º ÌïòÎã®Ïóê Î∞∞Ïπò
            const favoriteContacts = contactList.filter(contact => favoriteContactList.includes(contact.id));
            const regularContacts = contactList.filter(contact => !favoriteContactList.includes(contact.id));
            const sortedContacts = [...favoriteContacts, ...regularContacts];

            container.innerHTML = sortedContacts.map(contact => `
                <div class="transfer-item" onclick="selectContact('${contact.phone}', '${contact.name}')">
                    <div class="transfer-info">
                        <div class="transfer-name">${contact.name}</div>
                        <div class="transfer-details">${contact.phone}</div>
                    </div>
                    <button class="favorite-btn ${favoriteContactList.includes(contact.id) ? 'active' : ''}" 
                            onclick="toggleContactFavorite(event, ${contact.id})">‚òÖ</button>
                </div>
            `).join('');
        }

        // ÌÉ≠ Ï†ÑÌôò
        function switchTab(tabName) {
            // ÌÉ≠ Î≤ÑÌäº ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // ÌÉ≠ ÎÇ¥Ïö© Î≥ÄÍ≤Ω
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');

            // ÏÑ†ÌÉùÎêú ÏàòÏã†Ïûê Ï¥àÍ∏∞Ìôî
            document.getElementById('selectedRecipient').value = '';
        }

        // ÎÇ¥ Í≥ÑÏ¢å Î™©Î°ù ÌÜ†Í∏Ä
        function toggleMyAccounts() {
            const list = document.getElementById('myAccountsList');
            list.classList.toggle('expanded');
        }

        // ÎÇ¥ Í≥ÑÏ¢å ÏÑ†ÌÉù
        function selectMyAccount(accountNumber, bank) {
            document.getElementById('accountInput').value = `${accountNumber} (${bank})`;
            toggleMyAccounts(); // Î™©Î°ù Îã´Í∏∞
        }

        // ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ÏóêÏÑú ÏÑ†ÌÉù
        function selectRecentTransfer(accountNumber, name, bank) {
            document.getElementById('accountInput').value = `${accountNumber} (${bank})`;
            // ÎÇ¥Í≥ÑÏ¢åÏóê ÌëúÏãú ÌïÑÎìúÏóê Î∞õÎäî ÏÇ¨Îûå Ïù¥Î¶Ñ ÏûêÎèô ÏûÖÎ†•
            document.getElementById('receiverDisplay').value = name;
            // ÏûîÏï° Ïπ¥ÎìúÏùò Î∞õÎäî ÏÇ¨Îûå Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            updateReceiverInfo(accountNumber, bank);
        }

        // Ïó∞ÎùΩÏ≤òÏóêÏÑú ÏÑ†ÌÉù
        function selectContact(phone, name) {
            document.getElementById('contactInput').value = `${name} (${phone})`;
            // ÎÇ¥Í≥ÑÏ¢åÏóê ÌëúÏãú ÌïÑÎìúÏóê Ïó∞ÎùΩÏ≤ò Ïù¥Î¶Ñ ÏûêÎèô ÏûÖÎ†•
            document.getElementById('receiverDisplay').value = name;
        }

        // Ïó∞ÎùΩÏ≤ò Í≤ÄÏÉâ Ïó¥Í∏∞ (Î™®Ïùò Ìï®Ïàò)
        function openContactSearch() {
            showAlert('Ïó∞ÎùΩÏ≤ò Í≤ÄÏÉâ Í∏∞Îä•ÏùÄ Ï∂îÌõÑ Íµ¨ÌòÑ ÏòàÏ†ïÏûÖÎãàÎã§.', 'info', 'ÏïàÎÇ¥');
        }

        // Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò ÌÜ†Í∏Ä
        function toggleFavoriteContacts() {
            const list = document.getElementById('favoriteContactsList');
            list.classList.toggle('expanded');
        }

        // Ïó∞ÎùΩÏ≤ò Ï¶êÍ≤®Ï∞æÍ∏∞ ÌÜ†Í∏Ä
        function toggleContactFavorite(event, contactId) {
            event.stopPropagation();
            const index = favoriteContactList.indexOf(contactId);
            
            if (index > -1) {
                favoriteContactList.splice(index, 1);
            } else {
                favoriteContactList.push(contactId);
            }
            
            localStorage.setItem('favoriteContacts', JSON.stringify(favoriteContactList));
            
            // Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏ Î∞è Î™©Î°ù Îã§Ïãú Î†åÎçîÎßÅ
            updateFavoriteContactsCount();
            renderFavoriteContacts();
            renderContacts(contacts);
        }

        // Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò Ïπ¥Ïö¥Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
        function updateFavoriteContactsCount() {
            document.getElementById('favoriteContactsCount').textContent = favoriteContactList.length;
        }

        // Ï¶êÍ≤®Ï∞æÍ∏∞ Ïó∞ÎùΩÏ≤ò Î†åÎçîÎßÅ
        function renderFavoriteContacts() {
            const container = document.getElementById('favoriteContactsList');
            const favoriteContacts = contacts.filter(contact => favoriteContactList.includes(contact.id));
            
            if (favoriteContacts.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666; font-size: 12px;">Ï¶êÍ≤®Ï∞æÍ∏∞Îêú Ïó∞ÎùΩÏ≤òÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }

            container.innerHTML = favoriteContacts.map(contact => `
                <div class="account-item" onclick="selectContact('${contact.phone}', '${contact.name}')">
                    <div class="account-info">${contact.name}</div>
                    <div class="account-number">${contact.phone}</div>
                </div>
            `).join('');
        }

        // Ï¶êÍ≤®Ï∞æÍ∏∞ ÌÜ†Í∏Ä
        function toggleFavorite(event, transferId) {
            event.stopPropagation();
            const index = favorites.indexOf(transferId);
            
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(transferId);
            }
            
            localStorage.setItem('transferFavorites', JSON.stringify(favorites));
            
            // Î™©Î°ù Îã§Ïãú Î†åÎçîÎßÅ (Ï¶êÍ≤®Ï∞æÍ∏∞ ÏàúÏÑúÎ°ú Ï†ïÎ†¨)
            renderRecentTransfers(recentTransfers);
        }

        // ÏµúÍ∑º ÏÜ°Í∏à ÎÇ¥Ïó≠ Í≤ÄÏÉâ
        function searchRecentTransfers() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const filtered = recentTransfers.filter(transfer => 
                transfer.name.toLowerCase().includes(query) ||
                transfer.bank.toLowerCase().includes(query) ||
                transfer.accountNumber.includes(query)
            );
            // Í≤ÄÏÉâ Í≤∞Í≥ºÎèÑ Ï¶êÍ≤®Ï∞æÍ∏∞ ÏàúÏÑúÎ°ú Ï†ïÎ†¨
            renderRecentTransfers(filtered);
        }

        // Ïó∞ÎùΩÏ≤ò Í≤ÄÏÉâ
        function searchContacts() {
            const query = document.getElementById('contactSearch').value.toLowerCase();
            const filtered = contacts.filter(contact => 
                contact.name.toLowerCase().includes(query) ||
                contact.phone.includes(query)
            );
            renderContacts(filtered);
        }

        // Ïπ¥Î©îÎùºÎ°ú Í≥ÑÏ¢åÎ≤àÌò∏ Ïù∏Ïãù (Î™®Ïùò Íµ¨ÌòÑ)
        function openCamera() {
            // Ïã§Ï†úÎ°úÎäî Ïπ¥Î©îÎùº APIÎÇò OCR ÎùºÏù¥Î∏åÎü¨Î¶¨Î•º ÏÇ¨Ïö©
            showAlert('Ïπ¥Î©îÎùº Í∏∞Îä•ÏùÄ Ï∂îÌõÑ Íµ¨ÌòÑ ÏòàÏ†ïÏûÖÎãàÎã§.\nÏßÄÍ∏àÏùÄ ÏßÅÏ†ë Í≥ÑÏ¢åÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'info', 'ÏïàÎÇ¥');
        }

        // Í∏àÏï° Ìè¨Îß∑ÌåÖ
        function formatAmount(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            if (value) {
                value = parseInt(value).toLocaleString('ko-KR');
            }
            input.value = value;
            
            // Ïã§ÏãúÍ∞Ñ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            validateAmount(value);
        }

        // Í∏àÏï° Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
        function validateAmount(value) {
            const amount = parseInt(value.replace(/[^0-9]/g, '')) || 0;
            const errorElement = document.getElementById('amountError');
            
            if (amount < 1000) {
                errorElement.textContent = 'ÏµúÏÜå ÏÜ°Í∏à Í∏àÏï°ÏùÄ 1,000ÏõêÏûÖÎãàÎã§.';
            } else if (amount > 10000000) {
                errorElement.textContent = 'ÏµúÎåÄ ÏÜ°Í∏à Í∏àÏï°ÏùÄ 10,000,000ÏõêÏûÖÎãàÎã§.';
            } else {
                errorElement.textContent = '';
            }
        }

        // ÏÜ°Í∏à Ï≤òÎ¶¨ (ÌôïÏù∏ Î™®Îã¨ ÌëúÏãú)
        async function handleTransfer() {
            const accountInputValue = document.getElementById('accountInput').value;
            // Í≥ÑÏ¢åÎ≤àÌò∏ (ÏùÄÌñâÎ™Ö) ÌòïÏãùÏóêÏÑú Í≥ÑÏ¢åÎ≤àÌò∏ÏôÄ ÏùÄÌñâÎ™Ö Î∂ÑÎ¶¨
            const accountMatch = accountInputValue.match(/^(.+?)\s*\((.+?)\)$/);
            const accountNumber = accountMatch ? accountMatch[1].trim() : accountInputValue;
            const selectedBank = accountMatch ? accountMatch[2].trim() : '';
            const senderName = document.getElementById('senderName').value;
            const receiverName = document.getElementById('receiverDisplay').value || 'ÎØ∏ÏûÖÎ†•';
            const amountValue = document.getElementById('amount').value.replace(/[^0-9]/g, '');
            const amount = parseInt(amountValue);
            const memo = document.getElementById('memo').value || 'Î©îÎ™® ÏóÜÏùå';

            // Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (!accountNumber) {
                showAlert('Í≥ÑÏ¢åÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'ÏûÖÎ†• ÌôïÏù∏');
                return;
            }
            
            if (!senderName) {
                showAlert('Î∞õÎäîÍ≥ÑÏ¢åÏóê ÌëúÏãúÎê† Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'ÏûÖÎ†• ÌôïÏù∏');
                return;
            }

            if (!amount || amount < 1000) {
                showAlert('ÏµúÏÜå ÏÜ°Í∏à Í∏àÏï°ÏùÄ 1,000ÏõêÏûÖÎãàÎã§.', 'warning', 'Í∏àÏï° ÌôïÏù∏');
                return;
            }

            if (amount > 10000000) {
                showAlert('ÏµúÎåÄ ÏÜ°Í∏à Í∏àÏï°ÏùÄ 10,000,000ÏõêÏûÖÎãàÎã§.', 'warning', 'Í∏àÏï° ÌôïÏù∏');
                return;
            }

            // ÏÜ°Í∏à ÌôïÏù∏ Î™®Îã¨Ïóê Ï†ïÎ≥¥ ÌëúÏãú
            document.getElementById('confirmAccountNumber').textContent = accountNumber;
            document.getElementById('confirmBank').textContent = selectedBank || 'ÎØ∏ÌôïÏù∏';
            document.getElementById('confirmReceiverName').textContent = receiverName;
            document.getElementById('confirmAmount').textContent = new Intl.NumberFormat('ko-KR').format(amount) + 'Ïõê';
            document.getElementById('confirmMemo').textContent = memo;

            // PIN Ïù∏Ï¶ùÏùÑ ÌÜµÌïú ÏÜ°Í∏à ÌôïÏù∏
            showPinAuthentication('transfer', { 
                maxAttempts: 3,
                title: 'ÏÜ°Í∏à Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•'
            }, (success) => {
                if (success) {
                    // PIN Ïù∏Ï¶ù ÏÑ±Í≥µ Ïãú Ïã§Ï†ú ÏÜ°Í∏à Ï≤òÎ¶¨
                    processActualTransfer();
                } else {
                    // PIN Ïù∏Ï¶ù Ïã§Ìå® Ïãú ÏÜ°Í∏à Ï∑®ÏÜå
                    showAlert('ÏÜ°Í∏àÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.', 'info', 'ÏÜ°Í∏à Ï∑®ÏÜå');
                }
            });
        }

        // ÏÜ°Í∏à ÌôïÏù∏ Î™®Îã¨ Îã´Í∏∞
        function closeTransferConfirmModal() {
            document.getElementById('transferConfirmModal').classList.remove('show');
            document.body.style.overflow = '';
            // PIN Ï¥àÍ∏∞Ìôî
            clearPin();
        }

        // PIN Ïù∏Ï¶ùÏù¥ ÌïÑÏöîÌïú ÏÜ°Í∏à ÌôïÏù∏ (Î™®Îã¨ ÎÇ¥ Î≤ÑÌäºÏö©)
        function processTransferConfirm() {
            // Ïù¥ Ìï®ÏàòÎäî ÌòÑÏû¨ PIN Ïù∏Ï¶ù UIÍ∞Ä Ïù¥ÎØ∏ ÌëúÏãúÎêú ÏÉÅÌÉúÏóêÏÑú Ìò∏Ï∂úÎê®
            // PIN ÏûÖÎ†• ÏïàÎÇ¥ Î©îÏãúÏßÄÎßå ÌëúÏãú
            showAlert('ÏúÑÏùò ÌÇ§Ìå®ÎìúÎ•º ÏÇ¨Ïö©ÌïòÏó¨ 6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'info', 'Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•');
        }

        // Ïã§Ï†ú ÏÜ°Í∏à Ï≤òÎ¶¨ (PIN Ïù∏Ï¶ù ÏôÑÎ£å ÌõÑ Ïã§Ìñâ)
        async function processActualTransfer() {
            const accountInputValue = document.getElementById('accountInput').value;
            const accountMatch = accountInputValue.match(/^(.+?)\s*\((.+?)\)$/);
            const accountNumber = accountMatch ? accountMatch[1].trim() : accountInputValue;
            const receiverName = document.getElementById('receiverDisplay').value || 'Î∞õÎäîÎ∂Ñ';
            const amountValue = document.getElementById('amount').value.replace(/[^0-9]/g, '');
            const amount = parseInt(amountValue);
            const memo = document.getElementById('memo').value || 'ÏÜ°Í∏à';

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('loading').classList.add('show');
            document.getElementById('submitButton').disabled = true;

            const token = localStorage.getItem('accessToken');
            
            try {
                // PIN Ïù∏Ï¶ùÏùÑ Î®ºÏ†Ä ÏàòÌñâ
                const pinResponse = await fetch('/pin/verify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        pin: currentPin, // ÌòÑÏû¨ ÏûÖÎ†•Îêú PIN ÏÇ¨Ïö©
                        purpose: 'transfer'
                    })
                });

                const pinData = await pinResponse.json();

                if (!pinResponse.ok || !pinData.success) {
                    showAlert(pinData.message || 'PIN Ïù∏Ï¶ùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error', 'PIN Ïù∏Ï¶ù Ïã§Ìå®');
                    return;
                }

                // PIN Ïù∏Ï¶ù ÏÑ±Í≥µ ÌõÑ Î≥¥Ïïà ÏÜ°Í∏à API Ìò∏Ï∂ú
                const transferResponse = await fetch('/transfers/secure', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        receiverAccountNumber: accountNumber,
                        amount: amount,
                        memo: memo || 'ÏÜ°Í∏à',
                        pinSessionToken: pinData.sessionToken
                    })
                });

                const transferData = await transferResponse.json();

                if (transferResponse.ok && transferData.success) {
                    showAlert(`ÏÜ°Í∏àÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!\nÎ∞õÎäî ÏÇ¨Îûå: ${receiverName}\nÏÜ°Í∏àÏï°: ${new Intl.NumberFormat('ko-KR').format(amount)}Ïõê`, 'success', 'ÏÜ°Í∏à ÏôÑÎ£å', false, () => {
                        window.location.href = '/main.html';
                    });
                } else {
                    let errorMessage = 'ÏÜ°Í∏àÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.';
                    if (transferData.message) {
                        errorMessage = transferData.message;
                    }
                    showAlert(`ÏÜ°Í∏à Ïã§Ìå®: ${errorMessage}`, 'error', 'ÏÜ°Í∏à Ïã§Ìå®');
                }
            } catch (error) {
                console.error('Transfer error:', error);
                showAlert('ÏÜ°Í∏à Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error', 'Ïò§Î•ò Î∞úÏÉù');
            } finally {
                document.getElementById('loading').classList.remove('show');
                document.getElementById('submitButton').disabled = false;
            }
        }

        // Îí§Î°úÍ∞ÄÍ∏∞
        function goBack() {
            window.location.href = '/main.html';
        }

        // ÏùÄÌñâ Î∞è Ï¶ùÍ∂åÏÇ¨ Îç∞Ïù¥ÌÑ∞
        const bankData = [
            { code: 'NH', name: 'NHÎÜçÌòë', icon: 'üåæ' },
            { code: 'KAKAO', name: 'Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨', icon: 'üü°' },
            { code: 'KB', name: 'KBÍµ≠ÎØº', icon: 'üè¶' },
            { code: 'TOSS', name: 'ÌÜ†Ïä§Î±ÖÌÅ¨', icon: 'üí≥' },
            { code: 'SHINHAN', name: 'Ïã†Ìïú', icon: 'üîµ' },
            { code: 'WOORI', name: 'Ïö∞Î¶¨', icon: 'üü¢' },
            { code: 'IBK', name: 'IBKÍ∏∞ÏóÖ', icon: 'üè¢' },
            { code: 'HANA', name: 'ÌïòÎÇò', icon: 'üåø' },
            { code: 'SAEMAEUL', name: 'ÏÉàÎßàÏùÑ', icon: 'üè°' },
            { code: 'BUSAN', name: 'Î∂ÄÏÇ∞', icon: 'üåä' },
            { code: 'POST', name: 'Ïö∞Ï≤¥Íµ≠', icon: 'üì¨' },
            { code: 'SC', name: 'SCÏ†úÏùº', icon: 'üá¶' },
            { code: 'KBANK', name: 'ÏºÄÏù¥Î±ÖÌÅ¨', icon: 'üü®' },
            { code: 'SHINHYUP', name: 'Ïã†Ìòë', icon: 'ü§ù' }
        ];

        const securitiesData = [
            { code: 'MIRAE', name: 'ÎØ∏ÎûòÏóêÏÖã', icon: 'üìä' },
            { code: 'SAMSUNG', name: 'ÏÇºÏÑ±Ï¶ùÍ∂å', icon: 'üíπ' },
            { code: 'KB', name: 'KBÏ¶ùÍ∂å', icon: 'üìà' },
            { code: 'NH', name: 'NHÌà¨ÏûêÏ¶ùÍ∂å', icon: 'üåæ' },
            { code: 'HANTU', name: 'ÌïúÌà¨Ï¶ùÍ∂å', icon: 'üî¥' },
            { code: 'KIWOOM', name: 'ÌÇ§ÏõÄÏ¶ùÍ∂å', icon: 'üí∞' },
            { code: 'DAISHIN', name: 'ÎåÄÏã†Ï¶ùÍ∂å', icon: 'üü†' },
            { code: 'SHINHAN', name: 'Ïã†ÌïúÍ∏àÌà¨', icon: 'üîµ' },
            { code: 'HANA', name: 'ÌïòÎÇòÍ∏àÌà¨', icon: 'üåø' }
        ];

        // ÏùÄÌñâ/Ï¶ùÍ∂åÏÇ¨ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function initializeBankData() {
            const bankGrid = document.getElementById('bankGrid');
            const securitiesGrid = document.getElementById('securitiesGrid');

            // ÏùÄÌñâ Î™©Î°ù Î†åÎçîÎßÅ
            bankGrid.innerHTML = bankData.map(bank => `
                <div class="bank-item" data-type="bank" data-code="${bank.code}" onclick="selectBank('${bank.code}', '${bank.name}', 'bank')">
                    <span class="bank-icon">${bank.icon}</span>
                    <div class="bank-name">${bank.name}</div>
                </div>
            `).join('');

            // Ï¶ùÍ∂åÏÇ¨ Î™©Î°ù Î†åÎçîÎßÅ
            securitiesGrid.innerHTML = securitiesData.map(securities => `
                <div class="bank-item" data-type="securities" data-code="${securities.code}" onclick="selectBank('${securities.code}', '${securities.name}', 'securities')">
                    <span class="bank-icon">${securities.icon}</span>
                    <div class="bank-name">${securities.name}</div>
                </div>
            `).join('');
        }

        // Í≥ÑÏ¢å Î™®Îã¨ Ïó¥Í∏∞
        function openAccountModal() {
            // body Ïä§ÌÅ¨Î°§ÏùÑ Î®ºÏ†Ä ÎßâÍ∏∞
            document.body.style.overflow = 'hidden';
            
            const modal = document.getElementById('accountModal');
            modal.classList.add('show');
            
            // Í∏∞Ï°¥ ÏÑ†ÌÉù Ï¥àÍ∏∞Ìôî
            selectedBank = null;
            modalAccountNumber = '';
            document.getElementById('modalAccountInput').value = '';
            document.getElementById('confirmAccountBtn').disabled = true;
            
            // Î™®Îì† ÏÑ†ÌÉù Ìï¥Ï†ú
            document.querySelectorAll('.bank-item').forEach(item => {
                item.classList.remove('selected');
            });

            // ÏûÖÎ†• ÌïÑÎìúÏóê Ìè¨Ïª§Ïä§
            setTimeout(() => {
                document.getElementById('modalAccountInput').focus();
            }, 50);
        }

        // Î™®Îã¨ Ìó§ÎçîÏôÄ Ìë∏ÌÑ∞ ÏúÑÏπò Ï°∞Ï†ï
        function adjustModalHeaderFooter() {
            const modalContent = document.querySelector('.modal-content');
            const modalHeader = document.querySelector('.modal-header');
            const modalFooter = document.querySelector('.modal-footer');
            
            if (modalContent && modalHeader && modalFooter) {
                const contentRect = modalContent.getBoundingClientRect();
                
                // Ìó§ÎçîÎ•º Î™®Îã¨ ÏΩòÌÖêÏ∏† ÏÉÅÎã®Ïóê ÎßûÏ∂§
                modalHeader.style.left = contentRect.left + 'px';
                modalHeader.style.width = contentRect.width + 'px';
                modalHeader.style.top = contentRect.top + 'px';
                
                // Ìë∏ÌÑ∞Î•º Î™®Îã¨ ÏΩòÌÖêÏ∏† ÌïòÎã®Ïóê ÎßûÏ∂§
                modalFooter.style.left = contentRect.left + 'px';
                modalFooter.style.width = contentRect.width + 'px';
                modalFooter.style.bottom = (window.innerHeight - contentRect.bottom) + 'px';
            }
        }

        // Í≥ÑÏ¢å Î™®Îã¨ Îã´Í∏∞
        function closeAccountModal() {
            const modal = document.getElementById('accountModal');
            modal.classList.remove('show');
            
            // body Ïä§ÌÅ¨Î°§ Î≥µÏõê
            document.body.style.overflow = '';
        }

        // ÏùÄÌñâ/Ï¶ùÍ∂åÏÇ¨ ÏÑ†ÌÉù
        function selectBank(code, name, type) {
            // Ïù¥Ï†Ñ ÏÑ†ÌÉù Ìï¥Ï†ú
            document.querySelectorAll('.bank-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // ÏÉàÎ°úÏö¥ ÏÑ†ÌÉù Ï†ÅÏö©
            const selectedElement = document.querySelector(`[data-code="${code}"][data-type="${type}"]`);
            if (selectedElement) {
                selectedElement.classList.add('selected');
            }
            
            selectedBank = { code, name, type };
            updateConfirmButton();
        }

        // ÌôïÏù∏ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateConfirmButton() {
            const confirmBtn = document.getElementById('confirmAccountBtn');
            const isValid = selectedBank && modalAccountNumber.trim();
            confirmBtn.disabled = !isValid;
            
            if (isValid) {
                confirmBtn.classList.add('active');
            } else {
                confirmBtn.classList.remove('active');
            }
        }

        // Í≥ÑÏ¢å ÏÑ†ÌÉù ÌôïÏù∏
        function confirmAccount() {
            if (!selectedBank || !modalAccountNumber.trim()) {
                showAlert('ÏùÄÌñâÍ≥º Í≥ÑÏ¢åÎ≤àÌò∏Î•º Î™®Îëê ÏÑ†ÌÉù/ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'ÏûÖÎ†• ÌôïÏù∏');
                return;
            }
            
            // Î©îÏù∏ ÌéòÏù¥ÏßÄÏóê Ï†ïÎ≥¥ ÏÑ§Ï†ï - Í≥ÑÏ¢åÎ≤àÌò∏ (ÏùÄÌñâÎ™Ö) ÌòïÏãùÏúºÎ°ú ÌëúÏãú
            document.getElementById('accountInput').value = `${modalAccountNumber} (${selectedBank.name})`;
            
            // ÏûîÏï° Ïπ¥ÎìúÏùò Î∞õÎäî ÏÇ¨Îûå Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            updateReceiverInfo(modalAccountNumber, selectedBank.name);
            
            // Î™®Îã¨ Îã´Í∏∞
            closeAccountModal();
        }

        // Î∞õÎäî ÏÇ¨Îûå Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateReceiverInfo(accountNumber, bank) {
            const receiverAccountElement = document.getElementById('receiverAccountDisplay');
            const receiverBankElement = document.getElementById('receiverBankDisplay');
            
            if (accountNumber && bank) {
                receiverAccountElement.textContent = accountNumber;
                receiverBankElement.textContent = bank;
            } else {
                receiverAccountElement.textContent = '';
                receiverBankElement.textContent = '';
            }
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('accountModal');
            if (e.target === modal) {
                closeAccountModal();
            }
        });

        // Ï∂îÍ∞Ä Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        document.addEventListener('DOMContentLoaded', function() {
            // Î™®Îã¨ Í≥ÑÏ¢åÎ≤àÌò∏ ÏûÖÎ†• Ïù¥Î≤§Ìä∏
            const modalAccountInput = document.getElementById('modalAccountInput');
            if (modalAccountInput) {
                modalAccountInput.addEventListener('input', function(e) {
                    modalAccountNumber = e.target.value;
                    updateConfirmButton();
                });
            }
            
            // ESC ÌÇ§Î°ú Î™®Îã¨ Îã´Í∏∞
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modal = document.getElementById('accountModal');
                    if (modal && modal.classList.contains('show')) {
                        closeAccountModal();
                    }
                }
            });
            
            // Î™®Îã¨ Ïò§Î≤ÑÎ†àÏù¥ ÌÅ¥Î¶≠ Ïãú Î™®Îã¨ Îã´Í∏∞
            const modalOverlay = document.getElementById('accountModal');
            if (modalOverlay) {
                modalOverlay.addEventListener('click', function(e) {
                    if (e.target === modalOverlay) {
                        closeAccountModal();
                    }
                });
            }
            
        });

        // Î∞±Í∑∏ÎùºÏö¥Îìú ÌÜ†ÌÅ∞ Ï≤¥ÌÅ¨
        async function backgroundTokenCheck() {
            const accessToken = localStorage.getItem('accessToken');
            const refreshToken = localStorage.getItem('refreshToken');
            
            if (!accessToken || !refreshToken) {
                return;
            }

            try {
                const payload = JSON.parse(atob(accessToken.split('.')[1]));
                const expirationTime = payload.exp * 1000;
                const currentTime = Date.now();
                
                // ÎßåÎ£åÎêòÏóàÍ±∞ÎÇò Í≥ß ÎßåÎ£åÎê† ÏòàÏ†ïÏù¥Î©¥ Í∞±Ïã† ÏãúÎèÑ
                if (currentTime >= expirationTime || (expirationTime - currentTime < 60000)) {
                    console.log('üîÑ ÏÜ°Í∏à ÌéòÏù¥ÏßÄ Î∞±Í∑∏ÎùºÏö¥Îìú ÌÜ†ÌÅ∞ Í∞±Ïã† ÏãúÎèÑ...');
                    const success = await window.refreshToken(); // common.jsÏùò Ìï®Ïàò ÏÇ¨Ïö©
                    if (!success) {
                        console.log('‚ùå Î∞±Í∑∏ÎùºÏö¥Îìú ÌÜ†ÌÅ∞ Í∞±Ïã† Ïã§Ìå®, Î°úÍ∑∏ÏïÑÏõÉ');
                        showAutoLogoutPopup();
                    }
                }
            } catch (error) {
                console.error('Î∞±Í∑∏ÎùºÏö¥Îìú ÌÜ†ÌÅ∞ Ï≤¥ÌÅ¨ Ïò§Î•ò:', error);
                showAutoLogoutPopup();
            }
        }

        // ==========================================
        // Í≥µÌÜµ PIN Ïù∏Ï¶ù ÏÇ¨Ïö© ÏòàÏãú (Îã§Î•∏ ÌéòÏù¥ÏßÄÏóêÏÑú Ï∞∏Í≥†Ïö©)
        // ==========================================
        
        /*
        // Í≤∞Ï†úÏóêÏÑú PIN Ïù∏Ï¶ù ÏÇ¨Ïö© ÏòàÏãú
        function processPayment(paymentData) {
            showPinAuthentication('payment', {
                maxAttempts: 5,
                title: 'Í≤∞Ï†ú Ïù∏Ï¶ùÎ≤àÌò∏ ÏûÖÎ†•'
            }, (success) => {
                if (success) {
                    // PIN Ïù∏Ï¶ù ÏÑ±Í≥µ Ïãú Ïã§Ï†ú Í≤∞Ï†ú Ï≤òÎ¶¨
                    executePayment(paymentData);
                } else {
                    // PIN Ïù∏Ï¶ù Ïã§Ìå® Ïãú Í≤∞Ï†ú Ï∑®ÏÜå
                    showAlert('Í≤∞Ï†úÍ∞Ä Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.', 'info', 'Í≤∞Ï†ú Ï∑®ÏÜå');
                }
            });
        }

        // ÏùºÎ∞ò Î≥¥Ïïà Ïù∏Ï¶ùÏóêÏÑú ÏÇ¨Ïö© ÏòàÏãú
        function secureAction() {
            showPinAuthentication('common', {
                maxAttempts: 3,
                title: 'Î≥¥Ïïà Ïù∏Ï¶ùÏù¥ ÌïÑÏöîÌï©ÎãàÎã§'
            }, (success) => {
                if (success) {
                    // Î≥¥Ïïà Ïù∏Ï¶ù ÌõÑ ÏûëÏóÖ ÏàòÌñâ
                    performSecureAction();
                } else {
                    showAlert('Ïù∏Ï¶ùÏù¥ Ïã§Ìå®ÌïòÏó¨ ÏûëÏóÖÏù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.', 'warning');
                }
            });
        }
        */
    </script>
</body>
</html>